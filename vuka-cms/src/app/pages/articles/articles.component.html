<div class="articles-container">
  <h1>Articles</h1>

  <mat-form-field appearance="outline" class="filter-field">
    <mat-label>Filter Articles</mat-label>
    <input matInput (keyup)="applyFilter($event)" placeholder="Search by title, source, etc." #input>
    <mat-icon matSuffix>search</mat-icon>
  </mat-form-field>

  <div class="table-container mat-elevation-z4">
    <!-- Loading Spinner -->
    <div *ngIf="isLoading" class="spinner-container">
      <mat-progress-spinner color="primary" mode="indeterminate"></mat-progress-spinner>
    </div>

    <!-- Table Wrapper -->
    <div class="table-wrapper" [hidden]="isLoading">
      <table mat-table [dataSource]="dataSource" matSort>

        <!-- Is Featured Column -->
        <ng-container matColumnDef="isFeatured">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Featured </th>
          <td mat-cell *matCellDef="let article">
            <!-- Show filled star if featured -->
            <mat-icon *ngIf="article.isFeatured" class="featured-icon-filled" fontSet="material-symbols-rounded" matTooltip="Featured Article">kid_star</mat-icon>
            <!-- Show outlined star if not featured -->
            <mat-icon *ngIf="!article.isFeatured" class="featured-icon-outline" fontSet="material-symbols-outlined" matTooltip="Not Featured">kid_star</mat-icon>
          </td>
        </ng-container>

        <!-- Title Column -->
        <ng-container matColumnDef="title">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Title </th>
          <td mat-cell *matCellDef="let article" [matTooltip]="article.title">
            {{ article.title }}
          </td>
        </ng-container>

        <!-- Source Name Column -->
        <ng-container matColumnDef="sourceName">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Source </th>
          <td mat-cell *matCellDef="let article"> {{ article.source?.name }} </td>
        </ng-container>

        <!-- Published At Column -->
        <ng-container matColumnDef="publishedAt">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Published Date </th>
          <td mat-cell *matCellDef="let article">
            {{ article.publishedAt | date:'longDate' }}
          </td>
        </ng-container>

        <!-- Header and Row Definitions -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row (click)="openArticleDetails(row)" *matRowDef="let row; columns: displayedColumns;" class="article-row"></tr>

        <!-- Row to show when no data matches the filter -->
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell no-data-cell" [attr.colspan]="displayedColumns.length">
            No articles found matching your search "{{input.value}}"
          </td>
        </tr>
      </table>

      <mat-paginator
        [pageSizeOptions]="[10, 25, 50]"
        showFirstLastButtons
        aria-label="Select page of articles">
      </mat-paginator>
    </div>
  </div>
</div>
